import{A as x,a as L,c as wr,d as Z,e as Er,f as O,g as s,h as C,i as W,j as E,k as br,l as yr,m,n as R,o as k,p as A,q as g,r as S,s as D,t as j,u as N,v as G,w as xr,x as T,y as Y,z as $}from"./chunk-IVTHVDLB.js";import{Ba as U,ha as _r,xa as B}from"./chunk-SDI36ZKF.js";import{a as h}from"./chunk-M2JW2GFW.js";h();h();h();function I(r,e,n,o){var t;do t=Y(o);while(r.hasNode(t));return n.dummy=e,r.setNode(t,n),t}function kr(r){var e=new x().setGraph(r.graph());return s(r.nodes(),function(n){e.setNode(n,r.node(n))}),s(r.edges(),function(n){var o=e.edge(n.v,n.w)||{weight:0,minlen:1},t=r.edge(n);e.setEdge(n.v,n.w,{weight:o.weight+t.weight,minlen:Math.max(o.minlen,t.minlen)})}),e}function H(r){var e=new x({multigraph:r.isMultigraph()}).setGraph(r.graph());return s(r.nodes(),function(n){r.children(n).length||e.setNode(n,r.node(n))}),s(r.edges(),function(n){e.setEdge(n,r.edge(n))}),e}function rr(r,e){var n=r.x,o=r.y,t=e.x-n,i=e.y-o,a=r.width/2,f=r.height/2;if(!t&&!i)throw new Error("Not possible to find intersection inside of the rectangle");var u,d;return Math.abs(i)*a>Math.abs(t)*f?(i<0&&(f=-f),u=f*t/i,d=f):(t<0&&(a=-a),u=a,d=a*i/t),{x:n+u,y:o+d}}function M(r){var e=E(N(nr(r)+1),function(){return[]});return s(r.nodes(),function(n){var o=r.node(n),t=o.rank;k(t)||(e[t][o.order]=n)}),e}function gr(r){var e=S(E(r.nodes(),function(n){return r.node(n).rank}));s(r.nodes(),function(n){var o=r.node(n);m(o,"rank")&&(o.rank-=e)})}function Nr(r){var e=S(E(r.nodes(),function(i){return r.node(i).rank})),n=[];s(r.nodes(),function(i){var a=r.node(i).rank-e;n[a]||(n[a]=[]),n[a].push(i)});var o=0,t=r.graph().nodeRankFactor;s(n,function(i,a){k(i)&&a%t!==0?--o:o&&s(i,function(f){r.node(f).rank+=o})})}function er(r,e,n,o){var t={width:0,height:0};return arguments.length>=4&&(t.rank=n,t.order=o),I(r,"border",t,e)}function nr(r){return g(E(r.nodes(),function(e){var n=r.node(e).rank;if(!k(n))return n}))}function Ir(r,e){var n={lhs:[],rhs:[]};return s(r,function(o){e(o)?n.lhs.push(o):n.rhs.push(o)}),n}function Lr(r,e){var n=Z();try{return e()}finally{console.log(r+" time: "+(Z()-n)+"ms")}}function Cr(r,e){return e()}function Rr(r){function e(n){var o=r.children(n),t=r.node(n);if(o.length&&s(o,e),m(t,"minRank")){t.borderLeft=[],t.borderRight=[];for(var i=t.minRank,a=t.maxRank+1;i<a;++i)Tr(r,"borderLeft","_bl",n,t,i),Tr(r,"borderRight","_br",n,t,i)}}s(r.children(),e)}function Tr(r,e,n,o,t,i){var a={width:0,height:0,rank:i,borderType:e},f=t[e][i-1],u=I(r,"border",a,n);t[e][i]=u,r.setParent(u,o),f&&r.setEdge(f,u,{weight:1})}h();function Mr(r){var e=r.graph().rankdir.toLowerCase();(e==="lr"||e==="rl")&&Fr(r)}function Pr(r){var e=r.graph().rankdir.toLowerCase();(e==="bt"||e==="rl")&&me(r),(e==="lr"||e==="rl")&&(ve(r),Fr(r))}function Fr(r){s(r.nodes(),function(e){Sr(r.node(e))}),s(r.edges(),function(e){Sr(r.edge(e))})}function Sr(r){var e=r.width;r.width=r.height,r.height=e}function me(r){s(r.nodes(),function(e){or(r.node(e))}),s(r.edges(),function(e){var n=r.edge(e);s(n.points,or),m(n,"y")&&or(n)})}function or(r){r.y=-r.y}function ve(r){s(r.nodes(),function(e){tr(r.node(e))}),s(r.edges(),function(e){var n=r.edge(e);s(n.points,tr),m(n,"x")&&tr(n)})}function tr(r){var e=r.x;r.x=r.y,r.y=e}h();h();h();var J=class{constructor(){var e={};e._next=e._prev=e,this._sentinel=e}dequeue(){var e=this._sentinel,n=e._prev;if(n!==e)return Or(n),n}enqueue(e){var n=this._sentinel;e._prev&&e._next&&Or(e),e._next=n._next,n._next._prev=e,n._next=e,e._prev=n}toString(){for(var e=[],n=this._sentinel,o=n._prev;o!==n;)e.push(JSON.stringify(o,we)),o=o._prev;return"["+e.join(", ")+"]"}};function Or(r){r._prev._next=r._next,r._next._prev=r._prev,delete r._next,delete r._prev}function we(r,e){if(r!=="_next"&&r!=="_prev")return e}var Ee=B(1);function Gr(r,e){if(r.nodeCount()<=1)return[];var n=ye(r,e||Ee),o=be(n.graph,n.buckets,n.zeroIdx);return L(E(o,function(t){return r.outEdges(t.v,t.w)}))}function be(r,e,n){for(var o=[],t=e[e.length-1],i=e[0],a;r.nodeCount();){for(;a=i.dequeue();)ir(r,e,n,a);for(;a=t.dequeue();)ir(r,e,n,a);if(r.nodeCount()){for(var f=e.length-2;f>0;--f)if(a=e[f].dequeue(),a){o=o.concat(ir(r,e,n,a,!0));break}}}return o}function ir(r,e,n,o,t){var i=t?[]:void 0;return s(r.inEdges(o.v),function(a){var f=r.edge(a),u=r.node(a.v);t&&i.push({v:a.v,w:a.w}),u.out-=f,ar(e,n,u)}),s(r.outEdges(o.v),function(a){var f=r.edge(a),u=a.w,d=r.node(u);d.in-=f,ar(e,n,d)}),r.removeNode(o.v),i}function ye(r,e){var n=new x,o=0,t=0;s(r.nodes(),function(f){n.setNode(f,{v:f,in:0,out:0})}),s(r.edges(),function(f){var u=n.edge(f.v,f.w)||0,d=e(f),c=u+d;n.setEdge(f.v,f.w,c),t=Math.max(t,n.node(f.v).out+=d),o=Math.max(o,n.node(f.w).in+=d)});var i=N(t+o+3).map(function(){return new J}),a=o+1;return s(n.nodes(),function(f){ar(i,a,n.node(f))}),{graph:n,buckets:i,zeroIdx:a}}function ar(r,e,n){n.out?n.in?r[n.out-n.in+e].enqueue(n):r[r.length-1].enqueue(n):r[0].enqueue(n)}function Vr(r){var e=r.graph().acyclicer==="greedy"?Gr(r,n(r)):xe(r);s(e,function(o){var t=r.edge(o);r.removeEdge(o),t.forwardName=o.name,t.reversed=!0,r.setEdge(o.w,o.v,t,Y("rev"))});function n(o){return function(t){return o.edge(t).weight}}}function xe(r){var e=[],n={},o={};function t(i){m(o,i)||(o[i]=!0,n[i]=!0,s(r.outEdges(i),function(a){m(n,a.w)?e.push(a):t(a.w)}),delete n[i])}return s(r.nodes(),t),e}function Br(r){s(r.edges(),function(e){var n=r.edge(e);if(n.reversed){r.removeEdge(e);var o=n.forwardName;delete n.reversed,delete n.forwardName,r.setEdge(e.w,e.v,n,o)}})}h();function Dr(r){r.graph().dummyChains=[],s(r.edges(),function(e){ke(r,e)})}function ke(r,e){var n=e.v,o=r.node(n).rank,t=e.w,i=r.node(t).rank,a=e.name,f=r.edge(e),u=f.labelRank;if(i!==o+1){r.removeEdge(e);var d,c,l;for(l=0,++o;o<i;++l,++o)f.points=[],c={width:0,height:0,edgeLabel:f,edgeObj:e,rank:o},d=I(r,"edge",c,"_d"),o===u&&(c.width=f.width,c.height=f.height,c.dummy="edge-label",c.labelpos=f.labelpos),r.setEdge(n,d,{weight:f.weight},a),l===0&&r.graph().dummyChains.push(d),n=d;r.setEdge(n,t,{weight:f.weight},a)}}function jr(r){s(r.graph().dummyChains,function(e){var n=r.node(e),o=n.edgeLabel,t;for(r.setEdge(n.edgeObj,o);n.dummy;)t=r.successors(e)[0],r.removeNode(e),o.points.push({x:n.x,y:n.y}),n.dummy==="edge-label"&&(o.x=n.x,o.y=n.y,o.width=n.width,o.height=n.height),e=t,n=r.node(e)})}h();h();h();function q(r){var e={};function n(o){var t=r.node(o);if(m(e,o))return t.rank;e[o]=!0;var i=S(E(r.outEdges(o),function(a){return n(a.w)-r.edge(a).minlen}));return(i===Number.POSITIVE_INFINITY||i===void 0||i===null)&&(i=0),t.rank=i}s(r.sources(),n)}function V(r,e){return r.node(e.w).rank-r.node(e.v).rank-r.edge(e).minlen}function K(r){var e=new x({directed:!1}),n=r.nodes()[0],o=r.nodeCount();e.setNode(n,{});for(var t,i;ge(e,r)<o;)t=Ne(e,r),i=e.hasNode(t.v)?V(r,t):-V(r,t),Ie(e,r,i);return e}function ge(r,e){function n(o){s(e.nodeEdges(o),function(t){var i=t.v,a=o===i?t.w:i;!r.hasNode(a)&&!V(e,t)&&(r.setNode(a,{}),r.setEdge(o,a,{}),n(a))})}return s(r.nodes(),n),r.nodeCount()}function Ne(r,e){return D(e.edges(),function(n){if(r.hasNode(n.v)!==r.hasNode(n.w))return V(e,n)})}function Ie(r,e,n){s(r.nodes(),function(o){e.node(o).rank+=n})}h();h();h();h();h();var to=B(1);h();h();h();h();var vo=B(1);h();h();fr.CycleException=X;function fr(r){var e={},n={},o=[];function t(i){if(m(n,i))throw new X;m(e,i)||(n[i]=!0,e[i]=!0,s(r.predecessors(i),t),delete n[i],o.push(i))}if(s(r.sinks(),t),xr(e)!==r.nodeCount())throw new X;return o}function X(){}X.prototype=new Error;h();h();function Q(r,e,n){_r(e)||(e=[e]);var o=(r.isDirected()?r.successors:r.neighbors).bind(r),t=[],i={};return s(e,function(a){if(!r.hasNode(a))throw new Error("Graph does not have node: "+a);zr(r,a,n==="post",i,o,t)}),t}function zr(r,e,n,o,t,i){m(o,e)||(o[e]=!0,n||i.push(e),s(t(e),function(a){zr(r,a,n,o,t,i)}),n&&i.push(e))}function sr(r,e){return Q(r,e,"post")}h();function ur(r,e){return Q(r,e,"pre")}h();F.initLowLimValues=cr;F.initCutValues=dr;F.calcCutValue=Wr;F.leaveEdge=Xr;F.enterEdge=Hr;F.exchangeEdges=Jr;function F(r){r=kr(r),q(r);var e=K(r);cr(e),dr(e,r);for(var n,o;n=Xr(e);)o=Hr(e,r,n),Jr(e,r,n,o)}function dr(r,e){var n=sr(r,r.nodes());n=n.slice(0,n.length-1),s(n,function(o){Se(r,e,o)})}function Se(r,e,n){var o=r.node(n),t=o.parent;r.edge(n,t).cutvalue=Wr(r,e,n)}function Wr(r,e,n){var o=r.node(n),t=o.parent,i=!0,a=e.edge(n,t),f=0;return a||(i=!1,a=e.edge(t,n)),f=a.weight,s(e.nodeEdges(n),function(u){var d=u.v===n,c=d?u.w:u.v;if(c!==t){var l=d===i,v=e.edge(u).weight;if(f+=l?v:-v,Pe(r,n,c)){var _=r.edge(n,c).cutvalue;f+=l?-_:_}}}),f}function cr(r,e){arguments.length<2&&(e=r.nodes()[0]),qr(r,{},1,e)}function qr(r,e,n,o,t){var i=n,a=r.node(o);return e[o]=!0,s(r.neighbors(o),function(f){m(e,f)||(n=qr(r,e,n,f,o))}),a.low=i,a.lim=n++,t?a.parent=t:delete a.parent,n}function Xr(r){return W(r.edges(),function(e){return r.edge(e).cutvalue<0})}function Hr(r,e,n){var o=n.v,t=n.w;e.hasEdge(o,t)||(o=n.w,t=n.v);var i=r.node(o),a=r.node(t),f=i,u=!1;i.lim>a.lim&&(f=a,u=!0);var d=C(e.edges(),function(c){return u===Ur(r,r.node(c.v),f)&&u!==Ur(r,r.node(c.w),f)});return D(d,function(c){return V(e,c)})}function Jr(r,e,n,o){var t=n.v,i=n.w;r.removeEdge(t,i),r.setEdge(o.v,o.w,{}),cr(r),dr(r,e),Me(r,e)}function Me(r,e){var n=W(r.nodes(),function(t){return!e.node(t).parent}),o=ur(r,n);o=o.slice(1),s(o,function(t){var i=r.node(t).parent,a=e.edge(t,i),f=!1;a||(a=e.edge(i,t),f=!0),e.node(t).rank=e.node(i).rank+(f?a.minlen:-a.minlen)})}function Pe(r,e,n){return r.hasEdge(e,n)}function Ur(r,e,n){return n.low<=e.lim&&e.lim<=n.lim}function hr(r){switch(r.graph().ranker){case"network-simplex":Kr(r);break;case"tight-tree":Oe(r);break;case"longest-path":Fe(r);break;default:Kr(r)}}var Fe=q;function Oe(r){q(r),K(r)}function Kr(r){F(r)}h();function Qr(r){var e=I(r,"root",{},"_root"),n=Ge(r),o=g(R(n))-1,t=2*o+1;r.graph().nestingRoot=e,s(r.edges(),function(a){r.edge(a).minlen*=t});var i=Ve(r)+1;s(r.children(),function(a){Zr(r,e,t,i,o,n,a)}),r.graph().nodeRankFactor=t}function Zr(r,e,n,o,t,i,a){var f=r.children(a);if(!f.length){a!==e&&r.setEdge(e,a,{weight:0,minlen:n});return}var u=er(r,"_bt"),d=er(r,"_bb"),c=r.node(a);r.setParent(u,a),c.borderTop=u,r.setParent(d,a),c.borderBottom=d,s(f,function(l){Zr(r,e,n,o,t,i,l);var v=r.node(l),_=v.borderTop?v.borderTop:l,w=v.borderBottom?v.borderBottom:l,y=v.borderTop?o:2*o,z=_!==w?1:t-i[a]+1;r.setEdge(u,_,{weight:y,minlen:z,nestingEdge:!0}),r.setEdge(w,d,{weight:y,minlen:z,nestingEdge:!0})}),r.parent(a)||r.setEdge(e,u,{weight:0,minlen:t+i[a]})}function Ge(r){var e={};function n(o,t){var i=r.children(o);i&&i.length&&s(i,function(a){n(a,t+1)}),e[o]=t}return s(r.children(),function(o){n(o,1)}),e}function Ve(r){return G(r.edges(),function(e,n){return e+r.edge(n).weight},0)}function $r(r){var e=r.graph();r.removeNode(e.nestingRoot),delete e.nestingRoot,s(r.edges(),function(n){var o=r.edge(n);o.nestingEdge&&r.removeEdge(n)})}h();h();function re(r,e,n){var o={},t;s(n,function(i){for(var a=r.parent(i),f,u;a;){if(f=r.parent(a),f?(u=o[f],o[f]=a):(u=t,t=a),u&&u!==a){e.setEdge(u,a);return}a=f}})}h();function ee(r,e,n){var o=Ae(r),t=new x({compound:!0}).setGraph({root:o}).setDefaultNodeLabel(function(i){return r.node(i)});return s(r.nodes(),function(i){var a=r.node(i),f=r.parent(i);(a.rank===e||a.minRank<=e&&e<=a.maxRank)&&(t.setNode(i),t.setParent(i,f||o),s(r[n](i),function(u){var d=u.v===i?u.w:u.v,c=t.edge(d,i),l=k(c)?0:c.weight;t.setEdge(d,i,{weight:r.edge(u).weight+l})}),m(a,"minRank")&&t.setNode(i,{borderLeft:a.borderLeft[e],borderRight:a.borderRight[e]}))}),t}function Ae(r){for(var e;r.hasNode(e=Y("_root")););return e}h();function ne(r,e){for(var n=0,o=1;o<e.length;++o)n+=De(r,e[o-1],e[o]);return n}function De(r,e,n){for(var o=$(n,E(n,function(d,c){return c})),t=L(E(e,function(d){return T(E(r.outEdges(d),function(c){return{pos:o[c.w],weight:r.edge(c).weight}}),"pos")})),i=1;i<n.length;)i<<=1;var a=2*i-1;i-=1;var f=E(new Array(a),function(){return 0}),u=0;return s(t.forEach(function(d){var c=d.pos+i;f[c]+=d.weight;for(var l=0;c>0;)c%2&&(l+=f[c+1]),c=c-1>>1,f[c]+=d.weight;u+=d.weight*l})),u}h();function oe(r){var e={},n=C(r.nodes(),function(f){return!r.children(f).length}),o=g(E(n,function(f){return r.node(f).rank})),t=E(N(o+1),function(){return[]});function i(f){if(!m(e,f)){e[f]=!0;var u=r.node(f);t[u.rank].push(f),s(r.successors(f),i)}}var a=T(n,function(f){return r.node(f).rank});return s(a,i),t}h();h();function te(r,e){return E(e,function(n){var o=r.inEdges(n);if(o.length){var t=G(o,function(i,a){var f=r.edge(a),u=r.node(a.v);return{sum:i.sum+f.weight*u.order,weight:i.weight+f.weight}},{sum:0,weight:0});return{v:n,barycenter:t.sum/t.weight,weight:t.weight}}else return{v:n}})}h();function ie(r,e){var n={};s(r,function(t,i){var a=n[t.v]={indegree:0,in:[],out:[],vs:[t.v],i};k(t.barycenter)||(a.barycenter=t.barycenter,a.weight=t.weight)}),s(e.edges(),function(t){var i=n[t.v],a=n[t.w];!k(i)&&!k(a)&&(a.indegree++,i.out.push(n[t.w]))});var o=C(n,function(t){return!t.indegree});return je(o)}function je(r){var e=[];function n(i){return function(a){a.merged||(k(a.barycenter)||k(i.barycenter)||a.barycenter>=i.barycenter)&&Ye(i,a)}}function o(i){return function(a){a.in.push(i),--a.indegree===0&&r.push(a)}}for(;r.length;){var t=r.pop();e.push(t),s(t.in.reverse(),n(t)),s(t.out,o(t))}return E(C(e,function(i){return!i.merged}),function(i){return j(i,["vs","i","barycenter","weight"])})}function Ye(r,e){var n=0,o=0;r.weight&&(n+=r.barycenter*r.weight,o+=r.weight),e.weight&&(n+=e.barycenter*e.weight,o+=e.weight),r.vs=e.vs.concat(r.vs),r.barycenter=n/o,r.weight=o,r.i=Math.min(e.i,r.i),e.merged=!0}h();function fe(r,e){var n=Ir(r,function(c){return m(c,"barycenter")}),o=n.lhs,t=T(n.rhs,function(c){return-c.i}),i=[],a=0,f=0,u=0;o.sort(ze(!!e)),u=ae(i,t,u),s(o,function(c){u+=c.vs.length,i.push(c.vs),a+=c.barycenter*c.weight,f+=c.weight,u=ae(i,t,u)});var d={vs:L(i)};return f&&(d.barycenter=a/f,d.weight=f),d}function ae(r,e,n){for(var o;e.length&&(o=O(e)).i<=n;)e.pop(),r.push(o.vs),n++;return n}function ze(r){return function(e,n){return e.barycenter<n.barycenter?-1:e.barycenter>n.barycenter?1:r?n.i-e.i:e.i-n.i}}function lr(r,e,n,o){var t=r.children(e),i=r.node(e),a=i?i.borderLeft:void 0,f=i?i.borderRight:void 0,u={};a&&(t=C(t,function(w){return w!==a&&w!==f}));var d=te(r,t);s(d,function(w){if(r.children(w.v).length){var y=lr(r,w.v,n,o);u[w.v]=y,m(y,"barycenter")&&We(w,y)}});var c=ie(d,n);Ue(c,u);var l=fe(c,o);if(a&&(l.vs=L([a,l.vs,f]),r.predecessors(a).length)){var v=r.node(r.predecessors(a)[0]),_=r.node(r.predecessors(f)[0]);m(l,"barycenter")||(l.barycenter=0,l.weight=0),l.barycenter=(l.barycenter*l.weight+v.order+_.order)/(l.weight+2),l.weight+=2}return l}function Ue(r,e){s(r,function(n){n.vs=L(n.vs.map(function(o){return e[o]?e[o].vs:o}))})}function We(r,e){k(r.barycenter)?(r.barycenter=e.barycenter,r.weight=e.weight):(r.barycenter=(r.barycenter*r.weight+e.barycenter*e.weight)/(r.weight+e.weight),r.weight+=e.weight)}function de(r){var e=nr(r),n=se(r,N(1,e+1),"inEdges"),o=se(r,N(e-1,-1,-1),"outEdges"),t=oe(r);ue(r,t);for(var i=Number.POSITIVE_INFINITY,a,f=0,u=0;u<4;++f,++u){qe(f%2?n:o,f%4>=2),t=M(r);var d=ne(r,t);d<i&&(u=0,a=wr(t),i=d)}ue(r,a)}function se(r,e,n){return E(e,function(o){return ee(r,o,n)})}function qe(r,e){var n=new x;s(r,function(o){var t=o.graph().root,i=lr(o,t,n,e);s(i.vs,function(a,f){o.node(a).order=f}),re(o,n,i.vs)})}function ue(r,e){s(e,function(n){s(n,function(o,t){r.node(o).order=t})})}h();function ce(r){var e=He(r);s(r.graph().dummyChains,function(n){for(var o=r.node(n),t=o.edgeObj,i=Xe(r,e,t.v,t.w),a=i.path,f=i.lca,u=0,d=a[u],c=!0;n!==t.w;){if(o=r.node(n),c){for(;(d=a[u])!==f&&r.node(d).maxRank<o.rank;)u++;d===f&&(c=!1)}if(!c){for(;u<a.length-1&&r.node(d=a[u+1]).minRank<=o.rank;)u++;d=a[u]}r.setParent(n,d),n=r.successors(n)[0]}})}function Xe(r,e,n,o){var t=[],i=[],a=Math.min(e[n].low,e[o].low),f=Math.max(e[n].lim,e[o].lim),u,d;u=n;do u=r.parent(u),t.push(u);while(u&&(e[u].low>a||f>e[u].lim));for(d=u,u=o;(u=r.parent(u))!==d;)i.push(u);return{path:t.concat(i.reverse()),lca:d}}function He(r){var e={},n=0;function o(t){var i=n;s(r.children(t),o),e[t]={low:i,lim:n++}}return s(r.children(),o),e}h();h();function Je(r,e){var n={};function o(t,i){var a=0,f=0,u=t.length,d=O(i);return s(i,function(c,l){var v=Qe(r,c),_=v?r.node(v).order:u;(v||c===d)&&(s(i.slice(f,l+1),function(w){s(r.predecessors(w),function(y){var z=r.node(y),vr=z.order;(vr<a||_<vr)&&!(z.dummy&&r.node(w).dummy)&&he(n,y,w)})}),f=l+1,a=_)}),i}return G(e,o),n}function Ke(r,e){var n={};function o(i,a,f,u,d){var c;s(N(a,f),function(l){c=i[l],r.node(c).dummy&&s(r.predecessors(c),function(v){var _=r.node(v);_.dummy&&(_.order<u||_.order>d)&&he(n,v,c)})})}function t(i,a){var f=-1,u,d=0;return s(a,function(c,l){if(r.node(c).dummy==="border"){var v=r.predecessors(c);v.length&&(u=r.node(v[0]).order,o(a,d,l,f,u),d=l,f=u)}o(a,d,a.length,u,i.length)}),a}return G(e,t),n}function Qe(r,e){if(r.node(e).dummy)return W(r.predecessors(e),function(n){return r.node(n).dummy})}function he(r,e,n){if(e>n){var o=e;e=n,n=o}var t=r[e];t||(r[e]=t={}),t[n]=!0}function Ze(r,e,n){if(e>n){var o=e;e=n,n=o}return m(r[e],n)}function $e(r,e,n,o){var t={},i={},a={};return s(e,function(f){s(f,function(u,d){t[u]=u,i[u]=u,a[u]=d})}),s(e,function(f){var u=-1;s(f,function(d){var c=o(d);if(c.length){c=T(c,function(y){return a[y]});for(var l=(c.length-1)/2,v=Math.floor(l),_=Math.ceil(l);v<=_;++v){var w=c[v];i[d]===d&&u<a[w]&&!Ze(n,d,w)&&(i[w]=d,i[d]=t[d]=t[w],u=a[w])}}})}),{root:t,align:i}}function rn(r,e,n,o,t){var i={},a=en(r,e,n,t),f=t?"borderLeft":"borderRight";function u(l,v){for(var _=a.nodes(),w=_.pop(),y={};w;)y[w]?l(w):(y[w]=!0,_.push(w),_=_.concat(v(w))),w=_.pop()}function d(l){i[l]=a.inEdges(l).reduce(function(v,_){return Math.max(v,i[_.v]+a.edge(_))},0)}function c(l){var v=a.outEdges(l).reduce(function(w,y){return Math.min(w,i[y.w]-a.edge(y))},Number.POSITIVE_INFINITY),_=r.node(l);v!==Number.POSITIVE_INFINITY&&_.borderType!==f&&(i[l]=Math.max(i[l],v))}return u(d,a.predecessors.bind(a)),u(c,a.successors.bind(a)),s(o,function(l){i[l]=i[n[l]]}),i}function en(r,e,n,o){var t=new x,i=r.graph(),a=an(i.nodesep,i.edgesep,o);return s(e,function(f){var u;s(f,function(d){var c=n[d];if(t.setNode(c),u){var l=n[u],v=t.edge(l,c);t.setEdge(l,c,Math.max(a(r,d,u),v||0))}u=d})}),t}function nn(r,e){return D(R(e),function(n){var o=Number.NEGATIVE_INFINITY,t=Number.POSITIVE_INFINITY;return br(n,function(i,a){var f=fn(r,a)/2;o=Math.max(i+f,o),t=Math.min(i-f,t)}),o-t})}function on(r,e){var n=R(e),o=S(n),t=g(n);s(["u","d"],function(i){s(["l","r"],function(a){var f=i+a,u=r[f],d;if(u!==e){var c=R(u);d=a==="l"?o-S(c):t-g(c),d&&(r[f]=A(u,function(l){return l+d}))}})})}function tn(r,e){return A(r.ul,function(n,o){if(e)return r[e.toLowerCase()][o];var t=T(E(r,o));return(t[1]+t[2])/2})}function le(r){var e=M(r),n=U(Je(r,e),Ke(r,e)),o={},t;s(["u","d"],function(a){t=a==="u"?e:R(e).reverse(),s(["l","r"],function(f){f==="r"&&(t=E(t,function(l){return R(l).reverse()}));var u=(a==="u"?r.predecessors:r.successors).bind(r),d=$e(r,t,n,u),c=rn(r,t,d.root,d.align,f==="r");f==="r"&&(c=A(c,function(l){return-l})),o[a+f]=c})});var i=nn(r,o);return on(o,i),tn(o,r.graph().align)}function an(r,e,n){return function(o,t,i){var a=o.node(t),f=o.node(i),u=0,d;if(u+=a.width/2,m(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":d=-a.width/2;break;case"r":d=a.width/2;break}if(d&&(u+=n?d:-d),d=0,u+=(a.dummy?e:r)/2,u+=(f.dummy?e:r)/2,u+=f.width/2,m(f,"labelpos"))switch(f.labelpos.toLowerCase()){case"l":d=f.width/2;break;case"r":d=-f.width/2;break}return d&&(u+=n?d:-d),d=0,u}}function fn(r,e){return r.node(e).width}function pe(r){r=H(r),sn(r),yr(le(r),function(e,n){r.node(n).x=e})}function sn(r){var e=M(r),n=r.graph().ranksep,o=0;s(e,function(t){var i=g(E(t,function(a){return r.node(a).height}));s(t,function(a){r.node(a).y=o+i/2}),o+=i+n})}function un(r,e){var n=e&&e.debugTiming?Lr:Cr;n("layout",function(){var o=n("  buildLayoutGraph",function(){return bn(r)});n("  runLayout",function(){dn(o,n)}),n("  updateInputGraph",function(){cn(r,o)})})}function dn(r,e){e("    makeSpaceForEdgeLabels",function(){yn(r)}),e("    removeSelfEdges",function(){Rn(r)}),e("    acyclic",function(){Vr(r)}),e("    nestingGraph.run",function(){Qr(r)}),e("    rank",function(){hr(H(r))}),e("    injectEdgeLabelProxies",function(){xn(r)}),e("    removeEmptyRanks",function(){Nr(r)}),e("    nestingGraph.cleanup",function(){$r(r)}),e("    normalizeRanks",function(){gr(r)}),e("    assignRankMinMax",function(){kn(r)}),e("    removeEdgeLabelProxies",function(){gn(r)}),e("    normalize.run",function(){Dr(r)}),e("    parentDummyChains",function(){ce(r)}),e("    addBorderSegments",function(){Rr(r)}),e("    order",function(){de(r)}),e("    insertSelfEdges",function(){Sn(r)}),e("    adjustCoordinateSystem",function(){Mr(r)}),e("    position",function(){pe(r)}),e("    positionSelfEdges",function(){Mn(r)}),e("    removeBorderNodes",function(){Tn(r)}),e("    normalize.undo",function(){jr(r)}),e("    fixupEdgeLabelCoords",function(){Ln(r)}),e("    undoCoordinateSystem",function(){Pr(r)}),e("    translateGraph",function(){Nn(r)}),e("    assignNodeIntersects",function(){In(r)}),e("    reversePoints",function(){Cn(r)}),e("    acyclic.undo",function(){Br(r)})}function cn(r,e){s(r.nodes(),function(n){var o=r.node(n),t=e.node(n);o&&(o.x=t.x,o.y=t.y,e.children(n).length&&(o.width=t.width,o.height=t.height))}),s(r.edges(),function(n){var o=r.edge(n),t=e.edge(n);o.points=t.points,m(t,"x")&&(o.x=t.x,o.y=t.y)}),r.graph().width=e.graph().width,r.graph().height=e.graph().height}var hn=["nodesep","edgesep","ranksep","marginx","marginy"],ln={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},pn=["acyclicer","ranker","rankdir","align"],mn=["width","height"],vn={width:0,height:0},_n=["minlen","weight","width","height","labeloffset"],wn={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},En=["labelpos"];function bn(r){var e=new x({multigraph:!0,compound:!0}),n=mr(r.graph());return e.setGraph(U({},ln,pr(n,hn),j(n,pn))),s(r.nodes(),function(o){var t=mr(r.node(o));e.setNode(o,Er(pr(t,mn),vn)),e.setParent(o,r.parent(o))}),s(r.edges(),function(o){var t=mr(r.edge(o));e.setEdge(o,U({},wn,pr(t,_n),j(t,En)))}),e}function yn(r){var e=r.graph();e.ranksep/=2,s(r.edges(),function(n){var o=r.edge(n);o.minlen*=2,o.labelpos.toLowerCase()!=="c"&&(e.rankdir==="TB"||e.rankdir==="BT"?o.width+=o.labeloffset:o.height+=o.labeloffset)})}function xn(r){s(r.edges(),function(e){var n=r.edge(e);if(n.width&&n.height){var o=r.node(e.v),t=r.node(e.w),i={rank:(t.rank-o.rank)/2+o.rank,e};I(r,"edge-proxy",i,"_ep")}})}function kn(r){var e=0;s(r.nodes(),function(n){var o=r.node(n);o.borderTop&&(o.minRank=r.node(o.borderTop).rank,o.maxRank=r.node(o.borderBottom).rank,e=g(e,o.maxRank))}),r.graph().maxRank=e}function gn(r){s(r.nodes(),function(e){var n=r.node(e);n.dummy==="edge-proxy"&&(r.edge(n.e).labelRank=n.rank,r.removeNode(e))})}function Nn(r){var e=Number.POSITIVE_INFINITY,n=0,o=Number.POSITIVE_INFINITY,t=0,i=r.graph(),a=i.marginx||0,f=i.marginy||0;function u(d){var c=d.x,l=d.y,v=d.width,_=d.height;e=Math.min(e,c-v/2),n=Math.max(n,c+v/2),o=Math.min(o,l-_/2),t=Math.max(t,l+_/2)}s(r.nodes(),function(d){u(r.node(d))}),s(r.edges(),function(d){var c=r.edge(d);m(c,"x")&&u(c)}),e-=a,o-=f,s(r.nodes(),function(d){var c=r.node(d);c.x-=e,c.y-=o}),s(r.edges(),function(d){var c=r.edge(d);s(c.points,function(l){l.x-=e,l.y-=o}),m(c,"x")&&(c.x-=e),m(c,"y")&&(c.y-=o)}),i.width=n-e+a,i.height=t-o+f}function In(r){s(r.edges(),function(e){var n=r.edge(e),o=r.node(e.v),t=r.node(e.w),i,a;n.points?(i=n.points[0],a=n.points[n.points.length-1]):(n.points=[],i=t,a=o),n.points.unshift(rr(o,i)),n.points.push(rr(t,a))})}function Ln(r){s(r.edges(),function(e){var n=r.edge(e);if(m(n,"x"))switch((n.labelpos==="l"||n.labelpos==="r")&&(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset;break}})}function Cn(r){s(r.edges(),function(e){var n=r.edge(e);n.reversed&&n.points.reverse()})}function Tn(r){s(r.nodes(),function(e){if(r.children(e).length){var n=r.node(e),o=r.node(n.borderTop),t=r.node(n.borderBottom),i=r.node(O(n.borderLeft)),a=r.node(O(n.borderRight));n.width=Math.abs(a.x-i.x),n.height=Math.abs(t.y-o.y),n.x=i.x+n.width/2,n.y=o.y+n.height/2}}),s(r.nodes(),function(e){r.node(e).dummy==="border"&&r.removeNode(e)})}function Rn(r){s(r.edges(),function(e){if(e.v===e.w){var n=r.node(e.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e,label:r.edge(e)}),r.removeEdge(e)}})}function Sn(r){var e=M(r);s(e,function(n){var o=0;s(n,function(t,i){var a=r.node(t);a.order=i+o,s(a.selfEdges,function(f){I(r,"selfedge",{width:f.label.width,height:f.label.height,rank:a.rank,order:i+ ++o,e:f.e,label:f.label},"_se")}),delete a.selfEdges})})}function Mn(r){s(r.nodes(),function(e){var n=r.node(e);if(n.dummy==="selfedge"){var o=r.node(n.e.v),t=o.x+o.width/2,i=o.y,a=n.x-t,f=o.height/2;r.setEdge(n.e,n.label),r.removeNode(e),n.label.points=[{x:t+2*a/3,y:i-f},{x:t+5*a/6,y:i-f},{x:t+a,y:i},{x:t+5*a/6,y:i+f},{x:t+2*a/3,y:i+f}],n.label.x=n.x,n.label.y=n.y}})}function pr(r,e){return A(j(r,e),Number)}function mr(r){var e={};return s(r,function(n,o){e[o.toLowerCase()]=n}),e}h();export{un as a};
