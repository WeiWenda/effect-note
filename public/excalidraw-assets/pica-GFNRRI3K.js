import{a as z}from"./chunk-M2JW2GFW.js";import{a as T,d as X}from"./chunk-SXMPUQ6M.js";var N=X((L,W)=>{z();(function(Y){if(typeof L=="object"&&typeof W<"u")W.exports=Y();else if(typeof define=="function"&&define.amd)define([],Y);else{var H;typeof window<"u"?H=window:typeof global<"u"?H=global:typeof self<"u"?H=self:H=this,H.pica=Y()}})(function(){var Y,H,Z;return function(){function w(I,R,_){function u(t,r){if(!R[t]){if(!I[t]){var e=typeof T=="function"&&T;if(!r&&e)return e(t,!0);if(A)return A(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var h=R[t]={exports:{}};I[t][0].call(h.exports,function(c){var o=I[t][1][c];return u(o||c)},h,h.exports,w,I,R,_)}return R[t].exports}for(var A=typeof T=="function"&&T,n=0;n<_.length;n++)u(_[n]);return u}return w}()({1:[function(w,I,R){"use strict";var _=w("inherits"),u=w("multimath"),A=w("./mm_unsharp_mask"),n=w("./mm_resize");function t(r){var e=r||[],i={js:e.indexOf("js")>=0,wasm:e.indexOf("wasm")>=0};u.call(this,i),this.features={js:i.js,wasm:i.wasm&&this.has_wasm()},this.use(A),this.use(n)}_(t,u),t.prototype.resizeAndUnsharp=function(e,i){var h=this.resize(e,i);return e.unsharpAmount&&this.unsharp_mask(h,e.toWidth,e.toHeight,e.unsharpAmount,e.unsharpRadius,e.unsharpThreshold),h},I.exports=t},{"./mm_resize":4,"./mm_unsharp_mask":9,inherits:19,multimath:20}],2:[function(w,I,R){"use strict";function _(n){return n<0?0:n>255?255:n}function u(n,t,r,e,i,h){var c,o,v,d,m,p,B,y,E,G,b,F=0,D=0;for(E=0;E<e;E++){for(m=0,G=0;G<i;G++){for(p=h[m++],B=h[m++],y=F+p*4|0,c=o=v=d=0;B>0;B--)b=h[m++],d=d+b*n[y+3]|0,v=v+b*n[y+2]|0,o=o+b*n[y+1]|0,c=c+b*n[y]|0,y=y+4|0;t[D+3]=_(d+8192>>14),t[D+2]=_(v+8192>>14),t[D+1]=_(o+8192>>14),t[D]=_(c+8192>>14),D=D+e*4|0}D=(E+1)*4|0,F=(E+1)*r*4|0}}function A(n,t,r,e,i,h){var c,o,v,d,m,p,B,y,E,G,b,F=0,D=0;for(E=0;E<e;E++){for(m=0,G=0;G<i;G++){for(p=h[m++],B=h[m++],y=F+p*4|0,c=o=v=d=0;B>0;B--)b=h[m++],d=d+b*n[y+3]|0,v=v+b*n[y+2]|0,o=o+b*n[y+1]|0,c=c+b*n[y]|0,y=y+4|0;t[D+3]=_(d+8192>>14),t[D+2]=_(v+8192>>14),t[D+1]=_(o+8192>>14),t[D]=_(c+8192>>14),D=D+e*4|0}D=(E+1)*4|0,F=(E+1)*r*4|0}}I.exports={convolveHorizontally:u,convolveVertically:A}},{}],3:[function(w,I,R){"use strict";I.exports="AGFzbQEAAAAADAZkeWxpbmsAAAAAAAEXA2AAAGAGf39/f39/AGAHf39/f39/fwACDwEDZW52Bm1lbW9yeQIAAAMEAwABAgYGAX8AQQALB1cFEV9fd2FzbV9jYWxsX2N0b3JzAAAIY29udm9sdmUAAQpjb252b2x2ZUhWAAIMX19kc29faGFuZGxlAwAYX193YXNtX2FwcGx5X2RhdGFfcmVsb2NzAAAK7AMDAwABC8YDAQ9/AkAgA0UNACAERQ0AA0AgDCENQQAhE0EAIQcDQCAHQQJqIQYCfyAHQQF0IAVqIgcuAQIiFEUEQEGAwAAhCEGAwAAhCUGAwAAhCkGAwAAhCyAGDAELIBIgBy4BAGohCEEAIQsgFCEHQQAhDiAGIQlBACEPQQAhEANAIAUgCUEBdGouAQAiESAAIAhBAnRqKAIAIgpBGHZsIBBqIRAgCkH/AXEgEWwgC2ohCyAKQRB2Qf8BcSARbCAPaiEPIApBCHZB/wFxIBFsIA5qIQ4gCEEBaiEIIAlBAWohCSAHQQFrIgcNAAsgC0GAQGshCCAOQYBAayEJIA9BgEBrIQogEEGAQGshCyAGIBRqCyEHIAEgDUECdGogCUEOdSIGQf8BIAZB/wFIGyIGQQAgBkEAShtBCHRBgP4DcSAKQQ51IgZB/wEgBkH/AUgbIgZBACAGQQBKG0EQdEGAgPwHcSALQQ51IgZB/wEgBkH/AUgbIgZBACAGQQBKG0EYdHJyIAhBDnUiBkH/ASAGQf8BSBsiBkEAIAZBAEobcjYCACADIA1qIQ0gE0EBaiITIARHDQALIAxBAWoiDCACbCESIAMgDEcNAAsLCx4AQQAgAiADIAQgBSAAEAEgAkEAIAQgBSAGIAEQAQs="},{}],4:[function(w,I,R){"use strict";I.exports={name:"resize",fn:w("./resize"),wasm_fn:w("./resize_wasm"),wasm_src:w("./convolve_wasm_base64")}},{"./convolve_wasm_base64":3,"./resize":5,"./resize_wasm":8}],5:[function(w,I,R){"use strict";var _=w("./resize_filter_gen"),u=w("./convolve").convolveHorizontally,A=w("./convolve").convolveVertically;function n(t,r,e){for(var i=3,h=r*e*4|0;i<h;)t[i]=255,i=i+4|0}I.exports=function(r){var e=r.src,i=r.width,h=r.height,c=r.toWidth,o=r.toHeight,v=r.scaleX||r.toWidth/r.width,d=r.scaleY||r.toHeight/r.height,m=r.offsetX||0,p=r.offsetY||0,B=r.dest||new Uint8Array(c*o*4),y=typeof r.quality>"u"?3:r.quality,E=r.alpha||!1,G=_(y,i,c,v,m),b=_(y,h,o,d,p),F=new Uint8Array(c*h*4);return u(e,F,i,h,c,G),A(F,B,h,c,o,b),E||n(B,c,o),B}},{"./convolve":2,"./resize_filter_gen":6}],6:[function(w,I,R){"use strict";var _=w("./resize_filter_info"),u=14;function A(n){return Math.round(n*((1<<u)-1))}I.exports=function(t,r,e,i,h){var c=_[t].filter,o=1/i,v=Math.min(1,i),d=_[t].win/v,m,p,B,y,E,G,b,F,D,x,j,S,k,a,f,s,l,g=Math.floor((d+1)*2),M=new Int16Array((g+2)*e),C=0,Q=!M.subarray||!M.set;for(m=0;m<e;m++){for(p=(m+.5)*o+h,B=Math.max(0,Math.floor(p-d)),y=Math.min(r-1,Math.ceil(p+d)),E=y-B+1,G=new Float32Array(E),b=new Int16Array(E),F=0,D=B,x=0;D<=y;D++,x++)j=c((D+.5-p)*v),F+=j,G[x]=j;for(S=0,x=0;x<G.length;x++)k=G[x]/F,S+=k,b[x]=A(k);for(b[e>>1]+=A(1-S),a=0;a<b.length&&b[a]===0;)a++;if(a<b.length){for(f=b.length-1;f>0&&b[f]===0;)f--;if(s=B+a,l=f-a+1,M[C++]=s,M[C++]=l,!Q)M.set(b.subarray(a,f+1),C),C+=l;else for(x=a;x<=f;x++)M[C++]=b[x]}else M[C++]=0,M[C++]=0}return M}},{"./resize_filter_info":7}],7:[function(w,I,R){"use strict";I.exports=[{win:.5,filter:function(u){return u>=-.5&&u<.5?1:0}},{win:1,filter:function(u){if(u<=-1||u>=1)return 0;if(u>-11920929e-14&&u<11920929e-14)return 1;var A=u*Math.PI;return Math.sin(A)/A*(.54+.46*Math.cos(A/1))}},{win:2,filter:function(u){if(u<=-2||u>=2)return 0;if(u>-11920929e-14&&u<11920929e-14)return 1;var A=u*Math.PI;return Math.sin(A)/A*Math.sin(A/2)/(A/2)}},{win:3,filter:function(u){if(u<=-3||u>=3)return 0;if(u>-11920929e-14&&u<11920929e-14)return 1;var A=u*Math.PI;return Math.sin(A)/A*Math.sin(A/3)/(A/3)}}]},{}],8:[function(w,I,R){"use strict";var _=w("./resize_filter_gen");function u(r,e,i){for(var h=3,c=e*i*4|0;h<c;)r[h]=255,h=h+4|0}function A(r){return new Uint8Array(r.buffer,0,r.byteLength)}var n=!0;try{n=new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0]===1}catch{}function t(r,e,i){if(n){e.set(A(r),i);return}for(var h=i,c=0;c<r.length;c++){var o=r[c];e[h++]=o&255,e[h++]=o>>8&255}}I.exports=function(e){var i=e.src,h=e.width,c=e.height,o=e.toWidth,v=e.toHeight,d=e.scaleX||e.toWidth/e.width,m=e.scaleY||e.toHeight/e.height,p=e.offsetX||0,B=e.offsetY||0,y=e.dest||new Uint8Array(o*v*4),E=typeof e.quality>"u"?3:e.quality,G=e.alpha||!1,b=_(E,h,o,d,p),F=_(E,c,v,m,B),D=0,x=this.__align(D+Math.max(i.byteLength,y.byteLength)),j=this.__align(x+c*o*4),S=this.__align(j+b.byteLength),k=S+F.byteLength,a=this.__instance("resize",k),f=new Uint8Array(this.__memory.buffer),s=new Uint32Array(this.__memory.buffer),l=new Uint32Array(i.buffer);s.set(l),t(b,f,j),t(F,f,S);var g=a.exports.convolveHV||a.exports._convolveHV;g(j,S,x,h,c,o,v);var M=new Uint32Array(y.buffer);return M.set(new Uint32Array(this.__memory.buffer,0,v*o)),G||u(y,o,v),y}},{"./resize_filter_gen":6}],9:[function(w,I,R){"use strict";I.exports={name:"unsharp_mask",fn:w("./unsharp_mask"),wasm_fn:w("./unsharp_mask_wasm"),wasm_src:w("./unsharp_mask_wasm_base64")}},{"./unsharp_mask":10,"./unsharp_mask_wasm":11,"./unsharp_mask_wasm_base64":12}],10:[function(w,I,R){"use strict";var _=w("glur/mono16");function u(A,n,t){for(var r=n*t,e=new Uint16Array(r),i,h,c,o,v=0;v<r;v++)i=A[4*v],h=A[4*v+1],c=A[4*v+2],o=i>=h&&i>=c?i:h>=c&&h>=i?h:c,e[v]=o<<8;return e}I.exports=function(n,t,r,e,i,h){var c,o,v,d,m;if(!(e===0||i<.5)){i>2&&(i=2);var p=u(n,t,r),B=new Uint16Array(p);_(B,t,r,i);for(var y=e/100*4096+.5|0,E=h<<8,G=t*r,b=0;b<G;b++)c=p[b],d=c-B[b],Math.abs(d)>=E&&(o=c+(y*d+2048>>12),o=o>65280?65280:o,o=o<0?0:o,c=c!==0?c:1,v=(o<<12)/c|0,m=b*4,n[m]=n[m]*v+2048>>12,n[m+1]=n[m+1]*v+2048>>12,n[m+2]=n[m+2]*v+2048>>12)}}},{"glur/mono16":18}],11:[function(w,I,R){"use strict";I.exports=function(u,A,n,t,r,e){if(!(t===0||r<.5)){r>2&&(r=2);var i=A*n,h=i*4,c=i*2,o=i*2,v=Math.max(A,n)*4,d=8*4,m=0,p=h,B=p+c,y=B+o,E=y+o,G=E+v,b=this.__instance("unsharp_mask",h+c+o*2+v+d,{exp:Math.exp}),F=new Uint32Array(u.buffer),D=new Uint32Array(this.__memory.buffer);D.set(F);var x=b.exports.hsv_v16||b.exports._hsv_v16;x(m,p,A,n),x=b.exports.blurMono16||b.exports._blurMono16,x(p,B,y,E,G,A,n,r),x=b.exports.unsharp||b.exports._unsharp,x(m,m,p,B,A,n,t,e),F.set(new Uint32Array(this.__memory.buffer,0,i))}}},{}],12:[function(w,I,R){"use strict";I.exports="AGFzbQEAAAAADAZkeWxpbmsAAAAAAAE0B2AAAGAEf39/fwBgBn9/f39/fwBgCH9/f39/f39/AGAIf39/f39/f30AYAJ9fwBgAXwBfAIZAgNlbnYDZXhwAAYDZW52Bm1lbW9yeQIAAAMHBgAFAgQBAwYGAX8AQQALB4oBCBFfX3dhc21fY2FsbF9jdG9ycwABFl9fYnVpbGRfZ2F1c3NpYW5fY29lZnMAAg5fX2dhdXNzMTZfbGluZQADCmJsdXJNb25vMTYABAdoc3ZfdjE2AAUHdW5zaGFycAAGDF9fZHNvX2hhbmRsZQMAGF9fd2FzbV9hcHBseV9kYXRhX3JlbG9jcwABCsUMBgMAAQvWAQEHfCABRNuGukOCGvs/IAC7oyICRAAAAAAAAADAohAAIgW2jDgCFCABIAKaEAAiAyADoCIGtjgCECABRAAAAAAAAPA/IAOhIgQgBKIgAyACIAKgokQAAAAAAADwP6AgBaGjIgS2OAIAIAEgBSAEmqIiB7Y4AgwgASADIAJEAAAAAAAA8D+gIASioiIItjgCCCABIAMgAkQAAAAAAADwv6AgBKKiIgK2OAIEIAEgByAIoCAFRAAAAAAAAPA/IAahoCIDo7Y4AhwgASAEIAKgIAOjtjgCGAuGBQMGfwl8An0gAyoCDCEVIAMqAgghFiADKgIUuyERIAMqAhC7IRACQCAEQQFrIghBAEgiCQRAIAIhByAAIQYMAQsgAiAALwEAuCIPIAMqAhi7oiIMIBGiIg0gDCAQoiAPIAMqAgS7IhOiIhQgAyoCALsiEiAPoqCgoCIOtjgCACACQQRqIQcgAEECaiEGIAhFDQAgCEEBIAhBAUgbIgpBf3MhCwJ/IAQgCmtBAXFFBEAgDiENIAgMAQsgAiANIA4gEKIgFCASIAAvAQK4Ig+ioKCgIg22OAIEIAJBCGohByAAQQRqIQYgDiEMIARBAmsLIQIgC0EAIARrRg0AA0AgByAMIBGiIA0gEKIgDyAToiASIAYvAQC4Ig6ioKCgIgy2OAIAIAcgDSARoiAMIBCiIA4gE6IgEiAGLwECuCIPoqCgoCINtjgCBCAHQQhqIQcgBkEEaiEGIAJBAkohACACQQJrIQIgAA0ACwsCQCAJDQAgASAFIAhsQQF0aiIAAn8gBkECay8BACICuCINIBW7IhKiIA0gFrsiE6KgIA0gAyoCHLuiIgwgEKKgIAwgEaKgIg8gB0EEayIHKgIAu6AiDkQAAAAAAADwQWMgDkQAAAAAAAAAAGZxBEAgDqsMAQtBAAs7AQAgCEUNACAGQQRrIQZBACAFa0EBdCEBA0ACfyANIBKiIAJB//8DcbgiDSAToqAgDyIOIBCioCAMIBGioCIPIAdBBGsiByoCALugIgxEAAAAAAAA8EFjIAxEAAAAAAAAAABmcQRAIAyrDAELQQALIQMgBi8BACECIAAgAWoiACADOwEAIAZBAmshBiAIQQFKIQMgDiEMIAhBAWshCCADDQALCwvRAgIBfwd8AkAgB0MAAAAAWw0AIARE24a6Q4Ia+z8gB0MAAAA/l7ujIglEAAAAAAAAAMCiEAAiDLaMOAIUIAQgCZoQACIKIAqgIg22OAIQIAREAAAAAAAA8D8gCqEiCyALoiAKIAkgCaCiRAAAAAAAAPA/oCAMoaMiC7Y4AgAgBCAMIAuaoiIOtjgCDCAEIAogCUQAAAAAAADwP6AgC6KiIg+2OAIIIAQgCiAJRAAAAAAAAPC/oCALoqIiCbY4AgQgBCAOIA+gIAxEAAAAAAAA8D8gDaGgIgqjtjgCHCAEIAsgCaAgCqO2OAIYIAYEQANAIAAgBSAIbEEBdGogAiAIQQF0aiADIAQgBSAGEAMgCEEBaiIIIAZHDQALCyAFRQ0AQQAhCANAIAIgBiAIbEEBdGogASAIQQF0aiADIAQgBiAFEAMgCEEBaiIIIAVHDQALCwtxAQN/IAIgA2wiBQRAA0AgASAAKAIAIgRBEHZB/wFxIgIgAiAEQQh2Qf8BcSIDIAMgBEH/AXEiBEkbIAIgA0sbIgYgBiAEIAIgBEsbIAMgBEsbQQh0OwEAIAFBAmohASAAQQRqIQAgBUEBayIFDQALCwuZAgIDfwF8IAQgBWwhBAJ/IAazQwAAgEWUQwAAyEKVu0QAAAAAAADgP6AiC5lEAAAAAAAA4EFjBEAgC6oMAQtBgICAgHgLIQUgBARAIAdBCHQhCUEAIQYDQCAJIAIgBkEBdCIHai8BACIBIAMgB2ovAQBrIgcgB0EfdSIIaiAIc00EQCAAIAZBAnQiCGoiCiAFIAdsQYAQakEMdSABaiIHQYD+AyAHQYD+A0gbIgdBACAHQQBKG0EMdCABQQEgARtuIgEgCi0AAGxBgBBqQQx2OgAAIAAgCEEBcmoiByABIActAABsQYAQakEMdjoAACAAIAhBAnJqIgcgASAHLQAAbEGAEGpBDHY6AAALIAZBAWoiBiAERw0ACwsL"},{}],13:[function(w,I,R){"use strict";var _=100;function u(A,n){this.create=A,this.available=[],this.acquired={},this.lastId=1,this.timeoutId=0,this.idle=n||2e3}u.prototype.acquire=function(){var A=this,n;return this.available.length!==0?n=this.available.pop():(n=this.create(),n.id=this.lastId++,n.release=function(){return A.release(n)}),this.acquired[n.id]=n,n},u.prototype.release=function(A){var n=this;delete this.acquired[A.id],A.lastUsed=Date.now(),this.available.push(A),this.timeoutId===0&&(this.timeoutId=setTimeout(function(){return n.gc()},_))},u.prototype.gc=function(){var A=this,n=Date.now();this.available=this.available.filter(function(t){return n-t.lastUsed>A.idle?(t.destroy(),!1):!0}),this.available.length!==0?this.timeoutId=setTimeout(function(){return A.gc()},_):this.timeoutId=0},I.exports=u},{}],14:[function(w,I,R){"use strict";var _=2;I.exports=function(A,n,t,r,e,i){var h=t/A,c=r/n,o=(2*i+_+1)/e;if(o>.5)return[[t,r]];var v=Math.ceil(Math.log(Math.min(h,c))/Math.log(o));if(v<=1)return[[t,r]];for(var d=[],m=0;m<v;m++){var p=Math.round(Math.pow(Math.pow(A,v-m-1)*Math.pow(t,m+1),1/v)),B=Math.round(Math.pow(Math.pow(n,v-m-1)*Math.pow(r,m+1),1/v));d.push([p,B])}return d}},{}],15:[function(w,I,R){"use strict";var _=1e-5;function u(n){var t=Math.round(n);return Math.abs(n-t)<_?t:Math.floor(n)}function A(n){var t=Math.round(n);return Math.abs(n-t)<_?t:Math.ceil(n)}I.exports=function(t){var r=t.toWidth/t.width,e=t.toHeight/t.height,i=u(t.srcTileSize*r)-2*t.destTileBorder,h=u(t.srcTileSize*e)-2*t.destTileBorder;if(i<1||h<1)throw new Error("Internal error in pica: target tile width/height is too small.");var c,o,v,d,m,p,B=[],y;for(d=0;d<t.toHeight;d+=h)for(v=0;v<t.toWidth;v+=i)c=v-t.destTileBorder,c<0&&(c=0),m=v+i+t.destTileBorder-c,c+m>=t.toWidth&&(m=t.toWidth-c),o=d-t.destTileBorder,o<0&&(o=0),p=d+h+t.destTileBorder-o,o+p>=t.toHeight&&(p=t.toHeight-o),y={toX:c,toY:o,toWidth:m,toHeight:p,toInnerX:v,toInnerY:d,toInnerWidth:i,toInnerHeight:h,offsetX:c/r-u(c/r),offsetY:o/e-u(o/e),scaleX:r,scaleY:e,x:u(c/r),y:u(o/e),width:A(m/r),height:A(p/e)},B.push(y);return B}},{}],16:[function(w,I,R){"use strict";function _(u){return Object.prototype.toString.call(u)}I.exports.isCanvas=function(A){var n=_(A);return n==="[object HTMLCanvasElement]"||n==="[object OffscreenCanvas]"||n==="[object Canvas]"},I.exports.isImage=function(A){return _(A)==="[object HTMLImageElement]"},I.exports.isImageBitmap=function(A){return _(A)==="[object ImageBitmap]"},I.exports.limiter=function(A){var n=0,t=[];function r(){n<A&&t.length&&(n++,t.shift()())}return function(i){return new Promise(function(h,c){t.push(function(){i().then(function(o){h(o),n--,r()},function(o){c(o),n--,r()})}),r()})}},I.exports.cib_quality_name=function(A){switch(A){case 0:return"pixelated";case 1:return"low";case 2:return"medium"}return"high"},I.exports.cib_support=function(A){return Promise.resolve().then(function(){if(typeof createImageBitmap>"u")return!1;var n=A(100,100);return createImageBitmap(n,0,0,100,100,{resizeWidth:10,resizeHeight:10,resizeQuality:"high"}).then(function(t){var r=t.width===10;return t.close(),n=null,r})}).catch(function(){return!1})},I.exports.worker_offscreen_canvas_support=function(){return new Promise(function(A,n){if(typeof OffscreenCanvas>"u"){A(!1);return}function t(i){if(typeof createImageBitmap>"u"){i.postMessage(!1);return}Promise.resolve().then(function(){var h=new OffscreenCanvas(10,10),c=h.getContext("2d");return c.rect(0,0,1,1),createImageBitmap(h,0,0,1,1)}).then(function(){return i.postMessage(!0)},function(){return i.postMessage(!1)})}var r=btoa("(".concat(t.toString(),")(self);")),e=new Worker("data:text/javascript;base64,".concat(r));e.onmessage=function(i){return A(i.data)},e.onerror=n}).then(function(A){return A},function(){return!1})},I.exports.can_use_canvas=function(A){var n=!1;try{var t=A(2,1),r=t.getContext("2d"),e=r.createImageData(2,1);e.data[0]=12,e.data[1]=23,e.data[2]=34,e.data[3]=255,e.data[4]=45,e.data[5]=56,e.data[6]=67,e.data[7]=255,r.putImageData(e,0,0),e=null,e=r.getImageData(0,0,2,1),e.data[0]===12&&e.data[1]===23&&e.data[2]===34&&e.data[3]===255&&e.data[4]===45&&e.data[5]===56&&e.data[6]===67&&e.data[7]===255&&(n=!0)}catch{}return n},I.exports.cib_can_use_region=function(){return new Promise(function(A){if(typeof createImageBitmap>"u"){A(!1);return}var n=new Image;n.src="data:image/jpeg;base64,/9j/4QBiRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAYAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAAAAABIAAAAAQAAAEgAAAAB/9sAQwAEAwMEAwMEBAMEBQQEBQYKBwYGBgYNCQoICg8NEBAPDQ8OERMYFBESFxIODxUcFRcZGRsbGxAUHR8dGh8YGhsa/9sAQwEEBQUGBQYMBwcMGhEPERoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoa/8IAEQgAAQACAwERAAIRAQMRAf/EABQAAQAAAAAAAAAAAAAAAAAAAAf/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAF/P//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAQUCf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Bf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Bf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEABj8Cf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8hf//aAAwDAQACAAMAAAAQH//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Qf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Qf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8Qf//Z",n.onload=function(){createImageBitmap(n,0,0,n.width,n.height).then(function(t){t.width===n.width&&t.height===n.height?A(!0):A(!1)},function(){return A(!1)})},n.onerror=function(){return A(!1)}})}},{}],17:[function(w,I,R){"use strict";I.exports=function(){var _=w("./mathlib"),u;onmessage=function(n){var t=n.data.opts,r=!1;if(!t.src&&t.srcBitmap){var e=new OffscreenCanvas(t.width,t.height),i=e.getContext("2d",{alpha:!!t.alpha});i.drawImage(t.srcBitmap,0,0),t.src=i.getImageData(0,0,t.width,t.height).data,e.width=e.height=0,e=null,t.srcBitmap.close(),t.srcBitmap=null}u||(u=new _(n.data.features));var h=u.resizeAndUnsharp(t);if(r){var c=new ImageData(new Uint8ClampedArray(h),t.toWidth,t.toHeight),o=new OffscreenCanvas(t.toWidth,t.toHeight),v=o.getContext("2d",{alpha:!!t.alpha});v.putImageData(c,0,0),createImageBitmap(o).then(function(d){postMessage({bitmap:d},[d])})}else postMessage({data:h},[h.buffer])}}},{"./mathlib":1}],18:[function(w,I,R){var _,u,A,n,t,r,e,i;function h(v){v<.5&&(v=.5);var d=Math.exp(.726*.726)/v,m=Math.exp(-d),p=Math.exp(-2*d),B=(1-m)*(1-m)/(1+2*d*m-p);return _=B,u=B*(d-1)*m,A=B*(d+1)*m,n=-B*p,t=2*m,r=-p,e=(_+u)/(1-t-r),i=(A+n)/(1-t-r),new Float32Array([_,u,A,n,t,r,e,i])}function c(v,d,m,p,B,y){var E,G,b,F,D,x,j,S,k,a,f,s,l,g;for(k=0;k<y;k++){for(x=k*B,j=k,S=0,E=v[x],D=E*p[6],F=D,f=p[0],s=p[1],l=p[4],g=p[5],a=0;a<B;a++)G=v[x],b=G*f+E*s+F*l+D*g,D=F,F=b,E=G,m[S]=F,S++,x++;for(x--,S--,j+=y*(B-1),E=v[x],D=E*p[7],F=D,G=E,f=p[2],s=p[3],a=B-1;a>=0;a--)b=G*f+E*s+F*l+D*g,D=F,F=b,E=G,G=v[x],d[j]=m[S]+F,x--,S--,j-=y}}function o(v,d,m,p){if(p){var B=new Uint16Array(v.length),y=new Float32Array(Math.max(d,m)),E=h(p);c(v,B,y,E,d,m,p),c(B,v,y,E,m,d,p)}}I.exports=o},{}],19:[function(w,I,R){typeof Object.create=="function"?I.exports=function(u,A){A&&(u.super_=A,u.prototype=Object.create(A.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}))}:I.exports=function(u,A){if(A){u.super_=A;var n=function(){};n.prototype=A.prototype,u.prototype=new n,u.prototype.constructor=u}}},{}],20:[function(w,I,R){"use strict";var _=w("object-assign"),u=w("./lib/base64decode"),A=w("./lib/wa_detect"),n={js:!0,wasm:!0};function t(r){if(!(this instanceof t))return new t(r);var e=_({},n,r||{});if(this.options=e,this.__cache={},this.__init_promise=null,this.__modules=e.modules||{},this.__memory=null,this.__wasm={},this.__isLE=new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0]===1,!this.options.js&&!this.options.wasm)throw new Error('mathlib: at least "js" or "wasm" should be enabled')}t.prototype.has_wasm=A,t.prototype.use=function(r){return this.__modules[r.name]=r,this.options.wasm&&this.has_wasm()&&r.wasm_fn?this[r.name]=r.wasm_fn:this[r.name]=r.fn,this},t.prototype.init=function(){if(this.__init_promise)return this.__init_promise;if(!this.options.js&&this.options.wasm&&!this.has_wasm())return Promise.reject(new Error(`mathlib: only "wasm" was enabled, but it's not supported`));var r=this;return this.__init_promise=Promise.all(Object.keys(r.__modules).map(function(e){var i=r.__modules[e];return!r.options.wasm||!r.has_wasm()||!i.wasm_fn||r.__wasm[e]?null:WebAssembly.compile(r.__base64decode(i.wasm_src)).then(function(h){r.__wasm[e]=h})})).then(function(){return r}),this.__init_promise},t.prototype.__base64decode=u,t.prototype.__reallocate=function(e){if(!this.__memory)return this.__memory=new WebAssembly.Memory({initial:Math.ceil(e/(64*1024))}),this.__memory;var i=this.__memory.buffer.byteLength;return i<e&&this.__memory.grow(Math.ceil((e-i)/(64*1024))),this.__memory},t.prototype.__instance=function(e,i,h){if(i&&this.__reallocate(i),!this.__wasm[e]){var c=this.__modules[e];this.__wasm[e]=new WebAssembly.Module(this.__base64decode(c.wasm_src))}if(!this.__cache[e]){var o={memoryBase:0,memory:this.__memory,tableBase:0,table:new WebAssembly.Table({initial:0,element:"anyfunc"})};this.__cache[e]=new WebAssembly.Instance(this.__wasm[e],{env:_(o,h||{})})}return this.__cache[e]},t.prototype.__align=function(e,i){i=i||8;var h=e%i;return e+(h?i-h:0)},I.exports=t},{"./lib/base64decode":21,"./lib/wa_detect":22,"object-assign":23}],21:[function(w,I,R){"use strict";var _="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";I.exports=function(A){for(var n=A.replace(/[\r\n=]/g,""),t=n.length,r=new Uint8Array(t*3>>2),e=0,i=0,h=0;h<t;h++)h%4===0&&h&&(r[i++]=e>>16&255,r[i++]=e>>8&255,r[i++]=e&255),e=e<<6|_.indexOf(n.charAt(h));var c=t%4*6;return c===0?(r[i++]=e>>16&255,r[i++]=e>>8&255,r[i++]=e&255):c===18?(r[i++]=e>>10&255,r[i++]=e>>2&255):c===12&&(r[i++]=e>>4&255),r}},{}],22:[function(w,I,R){"use strict";var _;I.exports=function(){if(typeof _<"u"||(_=!1,typeof WebAssembly>"u"))return _;try{var A=new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11]),n=new WebAssembly.Module(A),t=new WebAssembly.Instance(n,{});return t.exports.test(4)!==0&&(_=!0),_}catch{}return _}},{}],23:[function(w,I,R){"use strict";var _=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;function n(r){if(r==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(r)}function t(){try{if(!Object.assign)return!1;var r=new String("abc");if(r[5]="de",Object.getOwnPropertyNames(r)[0]==="5")return!1;for(var e={},i=0;i<10;i++)e["_"+String.fromCharCode(i)]=i;var h=Object.getOwnPropertyNames(e).map(function(o){return e[o]});if(h.join("")!=="0123456789")return!1;var c={};return"abcdefghijklmnopqrst".split("").forEach(function(o){c[o]=o}),Object.keys(Object.assign({},c)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}I.exports=t()?Object.assign:function(r,e){for(var i,h=n(r),c,o=1;o<arguments.length;o++){i=Object(arguments[o]);for(var v in i)u.call(i,v)&&(h[v]=i[v]);if(_){c=_(i);for(var d=0;d<c.length;d++)A.call(i,c[d])&&(h[c[d]]=i[c[d]])}}return h}},{}],24:[function(w,I,R){var _=arguments[3],u=arguments[4],A=arguments[5],n=JSON.stringify;I.exports=function(t,r){for(var e,i=Object.keys(A),h=0,c=i.length;h<c;h++){var o=i[h],v=A[o].exports;if(v===t||v&&v.default===t){e=o;break}}if(!e){e=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var d={},h=0,c=i.length;h<c;h++){var o=i[h];d[o]=o}u[e]=["function(require,module,exports){"+t+"(self); }",d]}var m=Math.floor(Math.pow(16,8)*Math.random()).toString(16),p={};p[e]=e,u[m]=["function(require,module,exports){var f = require("+n(e)+");(f.default ? f.default : f)(self);}",p];var B={};y(m);function y(x){B[x]=!0;for(var j in u[x][1]){var S=u[x][1][j];B[S]||y(S)}}var E="("+_+")({"+Object.keys(B).map(function(x){return n(x)+":["+u[x][0]+","+n(u[x][1])+"]"}).join(",")+"},{},["+n(m)+"])",G=window.URL||window.webkitURL||window.mozURL||window.msURL,b=new Blob([E],{type:"text/javascript"});if(r&&r.bare)return b;var F=G.createObjectURL(b),D=new Worker(F);return D.objectURL=F,D}},{}],"/index.js":[function(w,I,R){"use strict";function _(a,f){return r(a)||t(a,f)||A(a,f)||u()}function u(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function A(a,f){if(a){if(typeof a=="string")return n(a,f);var s=Object.prototype.toString.call(a).slice(8,-1);if(s==="Object"&&a.constructor&&(s=a.constructor.name),s==="Map"||s==="Set")return Array.from(a);if(s==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return n(a,f)}}function n(a,f){(f==null||f>a.length)&&(f=a.length);for(var s=0,l=new Array(f);s<f;s++)l[s]=a[s];return l}function t(a,f){var s=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(s!=null){var l=[],g=!0,M=!1,C,Q;try{for(s=s.call(a);!(g=(C=s.next()).done)&&(l.push(C.value),!(f&&l.length===f));g=!0);}catch(U){M=!0,Q=U}finally{try{!g&&s.return!=null&&s.return()}finally{if(M)throw Q}}return l}}function r(a){if(Array.isArray(a))return a}var e=w("object-assign"),i=w("webworkify"),h=w("./lib/mathlib"),c=w("./lib/pool"),o=w("./lib/utils"),v=w("./lib/worker"),d=w("./lib/stepper"),m=w("./lib/tiler"),p={},B=!1;try{typeof navigator<"u"&&navigator.userAgent&&(B=navigator.userAgent.indexOf("Safari")>=0)}catch{}var y=1;typeof navigator<"u"&&(y=Math.min(navigator.hardwareConcurrency||1,4));var E={tile:1024,concurrency:y,features:["js","wasm","ww"],idle:2e3,createCanvas:function(f,s){var l=document.createElement("canvas");return l.width=f,l.height=s,l}},G={quality:3,alpha:!1,unsharpAmount:0,unsharpRadius:0,unsharpThreshold:0},b=!1,F=!1,D=!1,x=!1,j=!1;function S(){return{value:i(v),destroy:function(){if(this.value.terminate(),typeof window<"u"){var f=window.URL||window.webkitURL||window.mozURL||window.msURL;f&&f.revokeObjectURL&&this.value.objectURL&&f.revokeObjectURL(this.value.objectURL)}}}}function k(a){if(!(this instanceof k))return new k(a);this.options=e({},E,a||{});var f="lk_".concat(this.options.concurrency);this.__limit=p[f]||o.limiter(this.options.concurrency),p[f]||(p[f]=this.__limit),this.features={js:!1,wasm:!1,cib:!1,ww:!1},this.__workersPool=null,this.__requested_features=[],this.__mathlib=null}k.prototype.init=function(){var a=this;if(this.__initPromise)return this.__initPromise;if(typeof ImageData<"u"&&typeof Uint8ClampedArray<"u")try{new ImageData(new Uint8ClampedArray(400),10,10),b=!0}catch{}typeof ImageBitmap<"u"&&(ImageBitmap.prototype&&ImageBitmap.prototype.close?F=!0:this.debug("ImageBitmap does not support .close(), disabled"));var f=this.options.features.slice();if(f.indexOf("all")>=0&&(f=["cib","wasm","js","ww"]),this.__requested_features=f,this.__mathlib=new h(f),f.indexOf("ww")>=0&&typeof window<"u"&&"Worker"in window)try{var s=w("webworkify")(function(){});s.terminate(),this.features.ww=!0;var l="wp_".concat(JSON.stringify(this.options));p[l]?this.__workersPool=p[l]:(this.__workersPool=new c(S,this.options.idle),p[l]=this.__workersPool)}catch{}var g=this.__mathlib.init().then(function(U){e(a.features,U.features)}),M;F?M=o.cib_support(this.options.createCanvas).then(function(U){if(a.features.cib&&f.indexOf("cib")<0){a.debug("createImageBitmap() resize supported, but disabled by config");return}f.indexOf("cib")>=0&&(a.features.cib=U)}):M=Promise.resolve(!1),D=o.can_use_canvas(this.options.createCanvas);var C;F&&b&&f.indexOf("ww")!==-1?C=o.worker_offscreen_canvas_support():C=Promise.resolve(!1),C=C.then(function(U){x=U});var Q=o.cib_can_use_region().then(function(U){j=U});return this.__initPromise=Promise.all([g,M,C,Q]).then(function(){return a}),this.__initPromise},k.prototype.__invokeResize=function(a,f){var s=this;return f.__mathCache=f.__mathCache||{},Promise.resolve().then(function(){return s.features.ww?new Promise(function(l,g){var M=s.__workersPool.acquire();f.cancelToken&&f.cancelToken.catch(function(Q){return g(Q)}),M.value.onmessage=function(Q){M.release(),Q.data.err?g(Q.data.err):l(Q.data)};var C=[];a.src&&C.push(a.src.buffer),a.srcBitmap&&C.push(a.srcBitmap),M.value.postMessage({opts:a,features:s.__requested_features,preload:{wasm_nodule:s.__mathlib.__}},C)}):{data:s.__mathlib.resizeAndUnsharp(a,f.__mathCache)}})},k.prototype.__extractTileData=function(a,f,s,l,g){if(this.features.ww&&x&&(o.isCanvas(f)||j))return this.debug("Create tile for OffscreenCanvas"),createImageBitmap(l.srcImageBitmap||f,a.x,a.y,a.width,a.height).then(function(Q){return g.srcBitmap=Q,g});if(o.isCanvas(f))return l.srcCtx||(l.srcCtx=f.getContext("2d",{alpha:!!s.alpha})),this.debug("Get tile pixel data"),g.src=l.srcCtx.getImageData(a.x,a.y,a.width,a.height).data,g;this.debug("Draw tile imageBitmap/image to temporary canvas");var M=this.options.createCanvas(a.width,a.height),C=M.getContext("2d",{alpha:!!s.alpha});return C.globalCompositeOperation="copy",C.drawImage(l.srcImageBitmap||f,a.x,a.y,a.width,a.height,0,0,a.width,a.height),this.debug("Get tile pixel data"),g.src=C.getImageData(0,0,a.width,a.height).data,M.width=M.height=0,g},k.prototype.__landTileData=function(a,f,s){var l;if(this.debug("Convert raw rgba tile result to ImageData"),f.bitmap)return s.toCtx.drawImage(f.bitmap,a.toX,a.toY),null;if(b)l=new ImageData(new Uint8ClampedArray(f.data),a.toWidth,a.toHeight);else if(l=s.toCtx.createImageData(a.toWidth,a.toHeight),l.data.set)l.data.set(f.data);else for(var g=l.data.length-1;g>=0;g--)l.data[g]=f.data[g];return this.debug("Draw tile"),B?s.toCtx.putImageData(l,a.toX,a.toY,a.toInnerX-a.toX,a.toInnerY-a.toY,a.toInnerWidth+1e-5,a.toInnerHeight+1e-5):s.toCtx.putImageData(l,a.toX,a.toY,a.toInnerX-a.toX,a.toInnerY-a.toY,a.toInnerWidth,a.toInnerHeight),null},k.prototype.__tileAndResize=function(a,f,s){var l=this,g={srcCtx:null,srcImageBitmap:null,isImageBitmapReused:!1,toCtx:null},M=function(Q){return l.__limit(function(){if(s.canceled)return s.cancelToken;var U={width:Q.width,height:Q.height,toWidth:Q.toWidth,toHeight:Q.toHeight,scaleX:Q.scaleX,scaleY:Q.scaleY,offsetX:Q.offsetX,offsetY:Q.offsetY,quality:s.quality,alpha:s.alpha,unsharpAmount:s.unsharpAmount,unsharpRadius:s.unsharpRadius,unsharpThreshold:s.unsharpThreshold};return l.debug("Invoke resize math"),Promise.resolve(U).then(function(O){return l.__extractTileData(Q,a,s,g,O)}).then(function(O){return l.debug("Invoke resize math"),l.__invokeResize(O,s)}).then(function(O){return s.canceled?s.cancelToken:(g.srcImageData=null,l.__landTileData(Q,O,g))})})};return Promise.resolve().then(function(){if(g.toCtx=f.getContext("2d",{alpha:!!s.alpha}),o.isCanvas(a))return null;if(o.isImageBitmap(a))return g.srcImageBitmap=a,g.isImageBitmapReused=!0,null;if(o.isImage(a))return F?(l.debug("Decode image via createImageBitmap"),createImageBitmap(a).then(function(C){g.srcImageBitmap=C}).catch(function(C){return null})):null;throw new Error('Pica: ".from" should be Image, Canvas or ImageBitmap')}).then(function(){if(s.canceled)return s.cancelToken;l.debug("Calculate tiles");var C=m({width:s.width,height:s.height,srcTileSize:l.options.tile,toWidth:s.toWidth,toHeight:s.toHeight,destTileBorder:s.__destTileBorder}),Q=C.map(function(O){return M(O)});function U(O){O.srcImageBitmap&&(O.isImageBitmapReused||O.srcImageBitmap.close(),O.srcImageBitmap=null)}return l.debug("Process tiles"),Promise.all(Q).then(function(){return l.debug("Finished!"),U(g),f},function(O){throw U(g),O})})},k.prototype.__processStages=function(a,f,s,l){var g=this;if(l.canceled)return l.cancelToken;var M=a.shift(),C=_(M,2),Q=C[0],U=C[1],O=a.length===0;l=e({},l,{toWidth:Q,toHeight:U,quality:O?l.quality:Math.min(1,l.quality)});var P;return O||(P=this.options.createCanvas(Q,U)),this.__tileAndResize(f,O?s:P,l).then(function(){return O?s:(l.width=Q,l.height=U,g.__processStages(a,P,s,l))}).then(function(q){return P&&(P.width=P.height=0),q})},k.prototype.__resizeViaCreateImageBitmap=function(a,f,s){var l=this,g=f.getContext("2d",{alpha:!!s.alpha});return this.debug("Resize via createImageBitmap()"),createImageBitmap(a,{resizeWidth:s.toWidth,resizeHeight:s.toHeight,resizeQuality:o.cib_quality_name(s.quality)}).then(function(M){if(s.canceled)return s.cancelToken;if(!s.unsharpAmount)return g.drawImage(M,0,0),M.close(),g=null,l.debug("Finished!"),f;l.debug("Unsharp result");var C=l.options.createCanvas(s.toWidth,s.toHeight),Q=C.getContext("2d",{alpha:!!s.alpha});Q.drawImage(M,0,0),M.close();var U=Q.getImageData(0,0,s.toWidth,s.toHeight);return l.__mathlib.unsharp_mask(U.data,s.toWidth,s.toHeight,s.unsharpAmount,s.unsharpRadius,s.unsharpThreshold),g.putImageData(U,0,0),C.width=C.height=0,U=Q=C=g=null,l.debug("Finished!"),f})},k.prototype.resize=function(a,f,s){var l=this;this.debug("Start resize...");var g=e({},G);if(isNaN(s)?s&&(g=e(g,s)):g=e(g,{quality:s}),g.toWidth=f.width,g.toHeight=f.height,g.width=a.naturalWidth||a.width,g.height=a.naturalHeight||a.height,f.width===0||f.height===0)return Promise.reject(new Error("Invalid output size: ".concat(f.width,"x").concat(f.height)));g.unsharpRadius>2&&(g.unsharpRadius=2),g.canceled=!1,g.cancelToken&&(g.cancelToken=g.cancelToken.then(function(C){throw g.canceled=!0,C},function(C){throw g.canceled=!0,C}));var M=3;return g.__destTileBorder=Math.ceil(Math.max(M,2.5*g.unsharpRadius|0)),this.init().then(function(){if(g.canceled)return g.cancelToken;if(l.features.cib)return l.__resizeViaCreateImageBitmap(a,f,g);if(!D){var C=new Error("Pica: cannot use getImageData on canvas, make sure fingerprinting protection isn't enabled");throw C.code="ERR_GET_IMAGE_DATA",C}var Q=d(g.width,g.height,g.toWidth,g.toHeight,l.options.tile,g.__destTileBorder);return l.__processStages(Q,a,f,g)})},k.prototype.resizeBuffer=function(a){var f=this,s=e({},G,a);return this.init().then(function(){return f.__mathlib.resizeAndUnsharp(s)})},k.prototype.toBlob=function(a,f,s){return f=f||"image/png",new Promise(function(l){if(a.toBlob){a.toBlob(function(U){return l(U)},f,s);return}if(a.convertToBlob){l(a.convertToBlob({type:f,quality:s}));return}for(var g=atob(a.toDataURL(f,s).split(",")[1]),M=g.length,C=new Uint8Array(M),Q=0;Q<M;Q++)C[Q]=g.charCodeAt(Q);l(new Blob([C],{type:f}))})},k.prototype.debug=function(){},I.exports=k},{"./lib/mathlib":1,"./lib/pool":13,"./lib/stepper":14,"./lib/tiler":15,"./lib/utils":16,"./lib/worker":17,"object-assign":23,webworkify:24}]},{},[])("/index.js")})});export default N();
/*! Bundled license information:

pica/dist/pica.js:
  (*!
  
  pica
  https://github.com/nodeca/pica
  
  *)
  (*
  object-assign
  (c) Sindre Sorhus
  @license MIT
  *)
*/
